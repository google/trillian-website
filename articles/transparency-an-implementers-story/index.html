<!doctype html>

 <!--
  Copyright 2020 Google LLC
 
  Licensed under the Apache License, Version 2.0 (the 'License');
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at
 
       http://www.apache.org/licenses/LICENSE-2.0
 
  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an 'AS IS' BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
  -->

<html lang="en">

<head>
    <meta charset="utf-8">
    <title>
      
        
          Transparency: An Implementer&#39;s Story
         |
       Trillian
    </title>

    
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-173407084-1"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-173407084-1');
    </script>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&family=Google+Sans:wght@400;500;700&family=DM+Mono&display=swap&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://transparency.dev/css/styles.min.23bbbdf08e68ae404f6dcc666521c2f4bb1e5fa1892fa4d41bb8601d407aa603.css" integrity="sha256-I7u98I5orkBPbcxmZSHC9LseX6GJL6TUG7hgHUB6pgM=">
    <script>
      'use strict';

      function ready(fn) {
        if (document.attachEvent
          ? document.readyState === 'complete'
          : document.readyState !== 'loading') {
          fn();
        } else {
          document.addEventListener('DOMContentLoaded', fn);
        }
      }

      function addClass(el, className) {
        if (el.classList) {
          el.classList.add(className);
        } else {
          el.className += ' ' + className;
        }
      }

      function removeClass(el, className) {
        if (el.classList) {
          el.classList.remove(className);
        } else {
          el.className = el.className.replace(
              new RegExp('(^|\\b)' + className.split(' ').join('|') + '(\\b|$)', 'gi'), ' '
          );
        }
      }
    </script>
  </head>
<body>
    

<div class="bg-white z-50 w-full font-google" id="site-header">
<nav class="glue-page test-fixed">
  <div class="lg:hidden absolute h-16 flex items-center cursor-pointer">
    <div id="toggleMenu" class="h-8 flex items-center justify-left px-4 -mx-4 rounded text-Grey-700">
      <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24" fill="currentColor">
        <path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
      </svg>
    </div>
  </div>
  <ul class="mx-auto lg:float-left h-16 flex items-center">
    <li class="mx-auto"><a href='/' class="text-Grey-700" style="font-size: 22px; font-weight: normal;">Tamper-evident logs</a></li>
  </ul>
  <ul class="invisible lg:visible float-right h-16 flex items-center">
    <li class="text-right inline mr-6"><a href='/#applications' class="text-Grey-600 hover:no-underline">Applications</a></li>
    <li class="text-right inline mr-6"><a href='/how-to-design-a-verifiable-system/' class="text-Grey-600 hover:no-underline">Verifiable Design</a></li>
    <li class="text-right inline mr-6"><a href='/#trillian' class="text-Grey-600 hover:no-underline">Trillian</a></li>
    <li class="text-right inline mr-6"><a href='/verifiable-data-structures/' class="text-Grey-600 hover:no-underline">Verifiable Data Structures</a></li>
    <li class="text-right inline mr-6"><a href='/articles/' class="text-Grey-600 hover:no-underline">Articles</a></li>
    <li class="text-right inline mr-6"><a href="https://blog.transparency.dev" class="text-Grey-600 hover:no-underline">Blog</a></li>
  </ul>
</nav>
<ul id="mobileMenu" class="hidden bg-white p-8 fixed w-full z-50">
  <li class="gmb-2"><a href='/#applications' class="text-Grey-600 hover:no-underline">Applications</a></li>
  <li class="gmb-2"><a href='/how-to-design-a-verifiable-system/' class="text-Grey-600 hover:no-underline">Verifiable Design</a></li>
  <li class="gmb-2"><a href='/#trillian' class="text-Grey-600 hover:no-underline">Trillian</a></li>
  <li class="gmb-2"><a href='/verifiable-data-structures/' class="text-Grey-600 hover:no-underline">Verifiable Data Structures</a></li>
  <li class="gmb-2"><a href='/articles/' class="text-Grey-600 hover:no-underline">Articles</a></li>
  <li class=""><a href="https://blog.transparency.dev" class="text-Grey-600 hover:no-underline">Blog</a></li>
</ul>
</div>
<div id="nav-spacer" class="h-16"></div>

<script>
  'use strict';
  (function(){

    var doc = document.documentElement;
    var w = window;

    var prevScroll = w.scrollY || doc.scrollTop;
    var curScroll;
    var direction = 0;
    var prevDirection = 0;

    var header = document.getElementById('site-header');

    var checkScroll = function() {

      


      curScroll = w.scrollY || doc.scrollTop;
      if (curScroll > prevScroll) {
        
        direction = 2;
      }
      else if (curScroll < prevScroll) {
        
        direction = 1;
      }

      if (direction !== prevDirection) {
        toggleHeader(direction, curScroll);
      }

      prevScroll = curScroll;
    };

    var toggleHeader = function(direction, curScroll) {
      if (direction === 2 && curScroll > 64) {
        addClass(header, 'hide');
        addClass(mobileMenu, 'hidden');
        prevDirection = direction;
      }
      else if (direction === 1) {
        removeClass(header, 'hide');
        prevDirection = direction;
      }
    };

    const mobileMenu = document.getElementById('mobileMenu');

    function toggleMenuVisibility() {
      if (mobileMenu.classList.contains('hidden')) {
        removeClass(mobileMenu, 'hidden');
        return;
      };
      addClass(mobileMenu, 'hidden');
    };

    window.addEventListener('scroll', checkScroll);
    document.getElementById('toggleMenu').onclick = toggleMenuVisibility;

  })();
</script>

<div class="glue-page gmt-6 gmb-4 markdown">
  <div class="glue-grid">
    <div class="col-span-4 sm:col-span-12 md:col-span-10 md:col-start-2">
      <h1 class="headline2 md:text-center mb-5 md:mb-16">
        <div class="eyebrow"></div>
        Transparency: An Implementer&#39;s Story
      </h1>
    </div>
  </div>
  <div class="glue-grid">
    <aside class="submenu col-span-4 sm:col-span-6 md:col-span-4 lg:col-span-3 gmb-3">
      
      
        <p class="font-bold">
          Martin Hutchinson
        </p>
      
      
    </aside>
    <article id="content" class="col-span-4 sm:col-span-12 md:col-span-8 lg:col-span-6 gmb-7 markdown">
      <p>Aether’s team is responsible for running a binary download service. Naming is hard, so their service is simply called DownloadServer. Their service has some guarantees that the binary has not been tampered with, by validating a checksum on the client before any binaries are installed. Aether has a concern that this only mitigates some errors and threat models. If their download servers provide a different binary to some users along with a valid checksum then these clients could install malicious software without detection.</p>
<p>While Aether trusts his team and their security practices, he knows that there is still a risk of an insider threat or server compromise, and starts to research what steps can be taken to raise the bar for an attacker. After reading the <a href="https://github.com/google/trillian/blob/master/docs/claimantmodel/CoreModel.md">Claimant Model</a> and performing a Threat Model analysis, Aether devises the following model:</p>
<ul>
<li>Claim<sup>BINARY</sup>: (I, ${DownloadServer}, claim that binary X for platform P at version V has cryptographic checksum C)</li>
<li>Statement<sup>BINARY</sup>: A manifest file for X, containing P, V, C (and URLs, etc)</li>
<li>Claimant<sup>BINARY</sup>: DownloadServer</li>
<li>Believer<sup>BINARY</sup>: Download Client</li>
<li>Verifier<sup>BINARY</sup>: Clients and Publishers</li>
<li>Arbiter<sup>BINARY</sup>: DownloadServer’s community forums</li>
</ul>
<p>This Claimant Model description models how things currently work. Clients download the manifest file over HTTPS and then download the binary from the same server. They perform the checksum validation, and will raise any validation errors via the community. Publishers can download the manifests for binaries they have published from the server to ensure that nothing has been tampered with.</p>
<p>At first glance Aether thinks this provides enough transparency. After chatting with his pal Hypnos and sleeping on it, he realizes that his original concerns are still valid. While the manifest is obtained over TLS, it isn’t actually signed (which is a requirement for Statements in the Claimant Model), and thus cannot be shared in any peer-to-peer way that would allow mismatched manifests (i.e. those with X, P, V all being equal, but different C values) to be considered as proof; if users did share these and mismatches were found, DownloadServer could simply deny having authored either of them.</p>
<p>Aether proposes signing the manifests, which makes all manifests non-repudiable. Should two mismatching manifests be brought to light, DownloadServer could not dodge this and their reputation would be severely compromised. Their business model relies on this reputation, so this is an excellent deterrent for misbehavior and a great way to show their customers how much they care about security.</p>
<p>This step is rolled out, and receives some good press feedback. Their customers don’t seem to be sharing the manifest files though, which means in reality this checking isn’t happening and they could still get away with creating mismatched manifests.</p>
<p>Aether remembers the <a href="https://github.com/google/trillian/blob/master/docs/claimantmodel/Logs.md">Claimant Model of Logs</a> and realizes that this is a perfect fit. His team had discussed using immutable logs in the past, but their discussion had revolved around storing the binaries themselves in the logs. This was deemed infeasible because of space requirements, and because publishers occasionally realize they have leaked private info and request some binaries are taken down. Some publishers allow debug versions of the software to be downloaded by limited audiences through DownloadServer, but a public log would allow anyone to get this binary.</p>
<p>While the binaries themselves occasionally need to be redacted, or made private to limited audiences, none of their publishers are particularly concerned with the metadata in the manifest being public domain. The manifest files are pretty small, and so Aether proposes that a Trillian Log is set up with all of the manifest files stored as entries. Clients would be migrated from the current mechanism of downloading manifest files from direct HTTPS connections to fetching manifests from the log, and validating an inclusion proof against their local Golden Checkpoint. Whenever they needed to download a manifest from the server which is newer than their Golden Checkpoint, they would download the latest Checkpoint from the Log, verify it is consistent with their Golden Checkpoint via a consistency proof, and then replace their Golden Checkpoint with the newer version.</p>
<p>Aether proposes this to the team, and everyone agrees that this scheme is certainly more resilient than the current system, however a couple of points are raised by Erebus that require some more consideration:</p>
<ol>
<li>Mismatched manifests could still be put in the log, and if nobody checks all entries in the log for this type of mismatch then the problem is not mitigated</li>
<li>Different users could be presented with different versions of the log, and if they never compare checkpoints then this cannot be detected</li>
</ol>
<p>The first issue can be resolved by having a new Verifier that simply copies the log locally and checks for mismatched manifests. Ananke found this role so compelling that she hacked up a simple Verifier in a couple of hours that could easily run on a low powered Raspberry Pi.</p>
<p>Now the remaining issue is how to ensure that all users are on the same log timeline. The team discusses that this can be solved with a gossip protocol, but decide to launch the log early without solving this problem, reasoning that:</p>
<ul>
<li>Maintaining consistent split-views of the log indefinitely already raises the bar for the cost of successfully pulling off an attack</li>
<li>Users now have the option of sharing Log Checkpoints on the forums, which has a much better ROI than sharing each manifest directly; a single Log Checkpoint commits to all of the manifests in the log.</li>
<li>A proper gossip network can be added later without breaking changes</li>
</ul>
<p>And then everybody clapped.</p>

    </article>
  </div>
</div>


<div class="text-white bg-Grey-050 font-google font-medium footer">

  <div class="glue-page gpt-4 gpb-5">
    <div class="glue-grid">
      <div class="col-span-4 sm:col-span-5 sm:col-start-2">
        <h2 class="text-Grey-900">Learn more about tamper-evident logs</h2>
        <ul class="text-Grey-600">
          <li>
            <a href='/#benefits' class="text-Grey-600 hover:text-Grey-900 hover:no-underline">Benefits of tamper-evident logs</a>
          </li>
          <li>
            <a href='/#trillian' class="text-Grey-600 hover:text-Grey-900 hover:no-underline">Trillian: an open-source verifiable log</a>
          </li>
          <li>
            <a href='/verifiable-data-structures/' class="text-Grey-600 hover:text-Grey-900 hover:no-underline">Verifiable Data Structures</a>
          </li>
        </ul>
        </ul>
      </div>
      <div class="col-span-4 gmt-2 sm:col-span-5 sm:mt-0">
        <h2 class="text-Grey-900">Applications of tamper-evident logs</h2>
        <ul class="text-Grey-600 gmb-4">
          <li>
            <a href='/application/add-tamper-checking-to-a-package-manager' class="text-Grey-600 hover:text-Grey-900 hover:no-underline">Add tamper-checking to a package manager</a>
          </li>
          <li>
            <a href='/application/reliably-log-all-actions-performed-on-your-servers' class="text-Grey-600 hover:text-Grey-900 hover:no-underline">Reliably log all actions performed on your servers</a>
          </li>
          <li>
            <a href='/application/strengthen-discovery-of-encryption-keys' class="text-Grey-600 hover:text-Grey-900 hover:no-underline">Strengthen discovery of encryption keys with Key Transparency</a>
          </li>
          <li>
            <a href='/application/discourage-misbehaviour-by-third-parties-in-certificate-transparency' class="text-Grey-600 hover:text-Grey-900 hover:no-underline">Discourage misbehaviour by third parties in Certificate Transparency</a>
          </li>
        </ul>
      </div>
      <div class="col-span-4 sm:col-span-10 sm:col-start-2 border-t border-Grey-300 gpt-4 sm:flex">
        <img src="/images/logos/google-logo.svg" alt="Google's Logo" />
        <p class="mt-6 sm:mt-0 sm:ml-16 text-sm">
          <a href="/privacy/" class="text-Grey-600 hover:text-Grey-900 hover:no-underline">
            Privacy
          </a>
        </p>
      </div>
    </div>
  </div>
</div>



</body>
</html>
